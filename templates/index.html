<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Title</title>
    <link rel = 'stylesheet' href = "../static/style.css">
</head>
<body>
<div class= "container">

<div class ="binds">
<h1>Key Binds</h1>


<div class = "box">
    <div class = "hand-input">
        <h2 style = "padding:10px;">Closed Hand</h2>

<label class = "color" id = "closed" for = "closedInput">Value : </label>
<input type = "text"  id = "closedInput">

    <label for = "closedOff-repeat">Repeat</label>
    <input id = "closedOff-repeat" type = "checkbox">

    <label for = "closedOff-scroll">Scrolling Value</label>
    <input id ="closedOff-scroll" type = "text">
        <hr>
    </div>
<img src = '../static/handgraphics/closed.jpg' style = "width:90px; margin-left:50px;">
</div>
    <div class = "box">
<label class = "color" id = "pointer" for = "pointerInput">Pointer finger : </label>
<input type = "text"  id = "pointerInput">
<img src = '../static/handgraphics/pointer.png' style = "width:100px; margin-left:50px;">
    </div>
<div class = "box">
<label class = "color" id = "peace" for = "peaceInput">Peace Sign : </label>
<input type = "text"  id = "peaceInput">
<img src = '../static/handgraphics/peace.png' style = "width:100px; margin-left:50px;">
    </div>
    <div class = "box">
<label class = "color" id = "pinch1" for = "pinch1Input">Pinch In : </label>
<input type = "text" id = "pinch1Input">
<img src = '../static/handgraphics/pinch1.png' style = "width:100px; margin-left:50px;">
    </div>
       <div class = "box">
<label id = "pinch2" for = "pinch2Input">Pinch Out : </label>
<input type = "text"  id = "pinch2Input">
<img src = '../static/handgraphics/pinch1.png' style = "width:100px; margin-left:50px;">
    </div>
    <div class = "box">
<label class = "color" id = "rocker" for = "rockerInput">Rocker Sign : </label>
<input type = "text"  id = "rockerInput">
<img src = '../static/handgraphics/rocker.png' style = "width:100px; margin-left:50px;">
    </div>
    <div class = "box">
<label class = "color" id = "call" for = "callInput">Calling Sign : </label>
<input type = "text"  id = "callInput">
<img src = '../static/handgraphics/call.png' style = "width:100px; margin-left:50px;">
    </div>
        <div class = "box">
<label class = "color" id = "thumbs" for = "thumbsInput">Thumbs Up : </label>
<input type = "text"  id = "thumbsInput">
<img src = '../static/handgraphics/thumbs.png' style = "width:100px; margin-left:50px;">
    </div>

<h1 id = "response"></h1>
<button id = "allchanges" onclick = "sendData()" >Submit All Changes</button>
</div>

    <div class = "video">
        <h1>Camera</h1>
        <div>
        <label for = "toggle-webcam">Toggle Camera</label>
        <input type="checkbox" name="optionName" id = "toggle-webcam" value="optionValue">
            </div>
     <img src="/video_feed" id = "webcam">
</div>

    </div>



<script>
let isClicked = false;
// to do :
 try to fix toggle webcam,
 find a easier way to find out if a box was checked then save it and try to get the saved data into the front end
 fix front end css its lowkey ugly
 if you want to add more simple gestures ig do that too??
 //
document.addEventListener("DOMContentLoaded", () => {
  const webcam_off = document.getElementById('webcam');
  const toggleButton = document.getElementById('toggle-webcam');

toggleButton.addEventListener('change', () => {
  if (toggleButton.checked) {
    webcam_off.style.display = "none";
    fetch('/webcam', {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: 'True'
    });
  } else {
    webcam_off.style.display = "block";
    fetch('/webcam', {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: 'False'
    });
  }
});

  // Load saved keybinds
  fetch('/api/load')
    .then(res => {
      console.log("Response status:", res.status);
      return res.json();
    })
    .then(data => {
      console.log("Loaded data:", data);
      const array = ["closedOff","pointer","peace","pinch1","pinch2","rocker","call","thumbsup"];

      // array.forEach((key,i) =>{
      document.getElementById(key).value = data.finalKeybinds.array[i].value;
      document.getElementById(`${key}-scroll`).value = data.finalKeybinds.array[i].value;
      });//
      document.getElementById('closedInput').value = data.closedOff.value;
      document.getElementById('pointerInput').value = data.pointer.value;
      document.getElementById('peaceInput').value = data.peace.value;
      document.getElementById('pinch1Input').value = data.pinch1.value;
      document.getElementById('pinch2Input').value = data.pinch2.value;
      document.getElementById('rockerInput').value = data.rocker.value;
      document.getElementById('callInput').value = data.call.value;
      document.getElementById('thumbsInput').value = data.thumbsup.value;
    })
    .catch(err => console.error("Error loading data:", err));
});

function sendData() {
  const finalKeybinds = {
    finalKeybinds: {
      closedOff: {
        value: document.getElementById('closedInput').value,
        repeat: false,
        scroll: document.getElementById('closedInput-scroll').value
      },
      pointer: {
        value: document.getElementById('pointerInput').value,
        repeat: false,
        scroll: 0
      },
      peace: {
        value: document.getElementById('peaceInput').value,
        repeat: false,
        scroll: 0
      },
      pinch1: {
        value: 'scroll in',
        repeat: false,
        scroll: 150
      },
      pinch2: {
        value: 'scroll out',
        repeat: false,
        scroll: 150
      },
      rocker: {
        value: document.getElementById('rockerInput').value,
        repeat: false,
        scroll: 0
      },
      call: {
        value: document.getElementById('callInput').value,
        repeat: false,
        scroll: 0
      },
      thumbsup: {
        value: document.getElementById('thumbsInput').value,
        repeat: false,
        scroll: 0
      }
    }
  };

  console.log("Sending finalKeybinds:", finalKeybinds);

  fetch('/api/buttonclick', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(finalKeybinds)
  })
    .then(res => res.json())
    .then(data => {
      document.getElementById('response').textContent = data.message;
    })
    .catch(err => console.error("Error calling API:", err));
}

</script>

</body>
</html>